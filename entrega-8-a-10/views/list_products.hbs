<div class="products-list-container">
    <h3>Productos</h3>
    {{#if empty}}
        <label class="no-products">No hay Productos</label>
    {{else}}
        <ul class="products">
            {{#each products}}
                <li class="product">
                    <img class="thumbnail" src="{{this.thumbnail}}"/>
                    <label class="name">{{this.name}}</label>
                    <label class="price">$ {{this.price}}</label>
                    <button onclick="deleteProduct({{this.id}})">Borrar</button>
                </li>
            {{/each}}
        </ul>
    {{/if}}
</div>

<script>
    const send = async (to, method = 'GET', obj) => {
        const body = obj ? JSON.stringify(obj) : undefined;

        const response = await fetch(to, {
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            method,
            body
        })

        return await response.json();
    }
    
    const deleteProduct = async id => {
        const data = await send(`/api/products/delete/${id}`, 'DELETE');
        
        location.reload();
    }
</script>